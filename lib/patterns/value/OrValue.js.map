{"version":3,"sources":["../../../src/patterns/value/OrValue.js"],"names":["OrValue","ValuePatterns","constructor","name","patterns","reset","cursor","mark","index","errors","node","parse","assertCursor","tryPattern","ValueNode","value","Cursor","Error","pattern","error","push","length","moveToMark","throwError","reduce","furthestError","nextError","clone"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEe,MAAMA,OAAN,SAAsBC,sBAAtB,CAAoC;AACjDC,EAAAA,WAAW,CAACC,IAAD,EAAOC,QAAP,EAAiB;AAC1B,UAAMD,IAAN,EAAYC,QAAZ;AACA,SAAKC,KAAL;AACD;;AAEDA,EAAAA,KAAK,CAACC,MAAD,EAAS;AACZ,SAAKA,MAAL,GAAc,IAAd;AACA,SAAKC,IAAL,GAAY,IAAZ;AACA,SAAKC,KAAL,GAAa,CAAb;AACA,SAAKC,MAAL,GAAc,EAAd;AACA,SAAKC,IAAL,GAAY,IAAZ;;AAEA,QAAIJ,MAAM,IAAI,IAAd,EAAoB;AAClB,WAAKA,MAAL,GAAcA,MAAd;AACA,WAAKC,IAAL,GAAYD,MAAM,CAACC,IAAP,EAAZ;AACD;AACF;;AAEDI,EAAAA,KAAK,CAACL,MAAD,EAAS;AACZ,SAAKD,KAAL,CAAWC,MAAX;AACA,SAAKM,YAAL;AACA,SAAKC,UAAL;AAEA,WAAO,IAAIC,kBAAJ,CAAc,KAAKX,IAAnB,EAAyB,KAAKO,IAAL,CAAUK,KAAnC,CAAP;AACD;;AAEDH,EAAAA,YAAY,GAAG;AACb,QAAI,EAAE,KAAKN,MAAL,YAAuBU,eAAzB,CAAJ,EAAsC;AACpC,YAAM,IAAIC,KAAJ,CAAU,uCAAV,CAAN;AACD;AACF;;AAEDJ,EAAAA,UAAU,GAAG;AACX,WAAO,IAAP,EAAa;AACX,YAAMK,OAAO,GAAG,KAAKd,QAAL,CAAc,KAAKI,KAAnB,CAAhB;;AAEA,UAAI;AACF,aAAKE,IAAL,GAAYQ,OAAO,CAACP,KAAR,CAAc,KAAKL,MAAnB,CAAZ;AACA;AACD,OAHD,CAGE,OAAOa,KAAP,EAAc;AACd,aAAKV,MAAL,CAAYW,IAAZ,CAAiBD,KAAjB;;AAEA,YAAI,KAAKX,KAAL,GAAa,CAAb,GAAiB,KAAKJ,QAAL,CAAciB,MAAnC,EAA2C;AACzC,eAAKb,KAAL;AACA,eAAKF,MAAL,CAAYgB,UAAZ,CAAuB,KAAKf,IAA5B;AACD,SAHD,MAGO;AACL,eAAKgB,UAAL;AACD;AACF;AACF;AACF;;AAEDA,EAAAA,UAAU,GAAG;AACX,UAAMJ,KAAK,GAAG,KAAKV,MAAL,CAAYe,MAAZ,CAAmB,CAACC,aAAD,EAAgBC,SAAhB,KAA8B;AAC7D,UAAID,aAAa,CAACjB,KAAd,GAAsBkB,SAAS,CAAClB,KAApC,EAA2C;AACzC,eAAOiB,aAAP;AACD,OAFD,MAEO;AACL,eAAOC,SAAP;AACD;AACF,KANa,CAAd;AAQA,UAAMP,KAAN;AACD;;AAEDQ,EAAAA,KAAK,GAAG;AACN,WAAO,IAAI3B,OAAJ,CAAY,KAAKG,IAAjB,EAAuB,KAAKC,QAA5B,CAAP;AACD;;AAnEgD","sourcesContent":["import ValuePatterns from \"./ValuePatterns.js\";\nimport ValueNode from \"../../ast/ValueNode.js\";\nimport Cursor from \"../../Cursor.js\";\nimport ParseError from \"../ParseError.js\";\n\nexport default class OrValue extends ValuePatterns {\n  constructor(name, patterns) {\n    super(name, patterns);\n    this.reset();\n  }\n\n  reset(cursor) {\n    this.cursor = null;\n    this.mark = null;\n    this.index = 0;\n    this.errors = [];\n    this.node = null;\n\n    if (cursor != null) {\n      this.cursor = cursor;\n      this.mark = cursor.mark();\n    }\n  }\n\n  parse(cursor) {\n    this.reset(cursor);\n    this.assertCursor();\n    this.tryPattern();\n\n    return new ValueNode(this.name, this.node.value);\n  }\n\n  assertCursor() {\n    if (!(this.cursor instanceof Cursor)) {\n      throw new Error(\"Invalid Arguments: Expected a cursor.\");\n    }\n  }\n\n  tryPattern() {\n    while (true) {\n      const pattern = this.patterns[this.index];\n\n      try {\n        this.node = pattern.parse(this.cursor);\n        break;\n      } catch (error) {\n        this.errors.push(error);\n\n        if (this.index + 1 < this.patterns.length) {\n          this.index++;\n          this.cursor.moveToMark(this.mark);\n        } else {\n          this.throwError();\n        }\n      }\n    }\n  }\n\n  throwError() {\n    const error = this.errors.reduce((furthestError, nextError) => {\n      if (furthestError.index > nextError.index) {\n        return furthestError;\n      } else {\n        return nextError;\n      }\n    });\n\n    throw error;\n  }\n\n  clone() {\n    return new OrValue(this.name, this.patterns);\n  }\n}\n"],"file":"OrValue.js"}